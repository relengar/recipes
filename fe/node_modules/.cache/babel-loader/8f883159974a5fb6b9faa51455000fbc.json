{"ast":null,"code":"var _jsxFileName = \"/Users/dude/Documents/stuff/recipes/fe/src/components/navbar/login/Login.tsx\";\nimport React from 'react';\nimport { Formik, Form, Field, ErrorMessage } from 'formik';\nimport { useMutation } from '@apollo/react-hooks';\nimport { LOGIN, USER_FRAGMENT } from './login_query';\n\nfunction formatError(error) {\n  const splitMessage = error === null || error === void 0 ? void 0 : error.message.split(':');\n  const message = splitMessage.length > 1 ? splitMessage[1] : splitMessage[0];\n  return message.trim();\n}\n\nfunction Login({\n  loadUser\n}) {\n  const [login, {\n    error,\n    client\n  }] = useMutation(LOGIN, {\n    onError: () => {},\n    onCompleted: data => {\n      console.log(data);\n      loadUser();\n      client === null || client === void 0 ? void 0 : client.writeFragment({\n        id: data.id,\n        fragment: USER_FRAGMENT,\n        data: data\n      });\n    }\n  });\n  return React.createElement(Formik, {\n    initialValues: {\n      name: '',\n      password: ''\n    },\n    onSubmit: values => login({\n      variables: values\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32\n    },\n    __self: this\n  }, React.createElement(Form, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36\n    },\n    __self: this\n  }, React.createElement(Field, {\n    name: \"name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37\n    },\n    __self: this\n  }), React.createElement(ErrorMessage, {\n    name: \"name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38\n    },\n    __self: this\n  }), React.createElement(Field, {\n    type: \"password\",\n    name: \"password\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39\n    },\n    __self: this\n  }), React.createElement(ErrorMessage, {\n    name: \"password\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41\n    },\n    __self: this\n  }, \"Login\"), error && React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42\n    },\n    __self: this\n  }, formatError(error))));\n}\n\nexport default Login;","map":{"version":3,"sources":["/Users/dude/Documents/stuff/recipes/fe/src/components/navbar/login/Login.tsx"],"names":["React","Formik","Form","Field","ErrorMessage","useMutation","LOGIN","USER_FRAGMENT","formatError","error","splitMessage","message","split","length","trim","Login","loadUser","login","client","onError","onCompleted","data","console","log","writeFragment","id","fragment","name","password","values","variables"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,MAAT,EAAiBC,IAAjB,EAAuBC,KAAvB,EAA8BC,YAA9B,QAAkD,QAAlD;AACA,SAASC,WAAT,QAA4B,qBAA5B;AACA,SAASC,KAAT,EAAgBC,aAAhB,QAAqC,eAArC;;AAOA,SAASC,WAAT,CAAqBC,KAArB,EAAiD;AAC7C,QAAMC,YAAY,GAAGD,KAAH,aAAGA,KAAH,uBAAGA,KAAK,CAAEE,OAAP,CAAeC,KAAf,CAAqB,GAArB,CAArB;AACA,QAAMD,OAAO,GAAID,YAAY,CAACG,MAAb,GAAsB,CAAtB,GAA0BH,YAAY,CAAC,CAAD,CAAtC,GAA4CA,YAAY,CAAC,CAAD,CAAzE;AACA,SAAOC,OAAO,CAACG,IAAR,EAAP;AACH;;AAED,SAASC,KAAT,CAAe;AAACC,EAAAA;AAAD,CAAf,EAAuC;AACnC,QAAM,CAAEC,KAAF,EAAS;AAAER,IAAAA,KAAF;AAASS,IAAAA;AAAT,GAAT,IAA+Bb,WAAW,CAACC,KAAD,EAAQ;AACpDa,IAAAA,OAAO,EAAE,MAAM,CAAE,CADmC;AAEpDC,IAAAA,WAAW,EAAGC,IAAD,IAAU;AACnBC,MAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ;AACAL,MAAAA,QAAQ;AACRE,MAAAA,MAAM,SAAN,IAAAA,MAAM,WAAN,YAAAA,MAAM,CAAEM,aAAR,CAAsB;AAClBC,QAAAA,EAAE,EAAEJ,IAAI,CAACI,EADS;AAElBC,QAAAA,QAAQ,EAAEnB,aAFQ;AAGlBc,QAAAA,IAAI,EAAEA;AAHY,OAAtB;AAKH;AAVmD,GAAR,CAAhD;AAaA,SACI,oBAAC,MAAD;AACI,IAAA,aAAa,EAAE;AAACM,MAAAA,IAAI,EAAE,EAAP;AAAWC,MAAAA,QAAQ,EAAE;AAArB,KADnB;AAEI,IAAA,QAAQ,EAAGC,MAAD,IAAYZ,KAAK,CAAC;AAACa,MAAAA,SAAS,EAAED;AAAZ,KAAD,CAF/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAII,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,KAAD;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAEI,oBAAC,YAAD;AAAc,IAAA,IAAI,EAAC,MAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,EAGI,oBAAC,KAAD;AAAO,IAAA,IAAI,EAAC,UAAZ;AAAuB,IAAA,IAAI,EAAC,UAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHJ,EAII,oBAAC,YAAD;AAAc,IAAA,IAAI,EAAC,UAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJJ,EAKI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aALJ,EAMKpB,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAOD,WAAW,CAACC,KAAD,CAAlB,CANd,CAJJ,CADJ;AAeH;;AAED,eAAeM,KAAf","sourcesContent":["import React from 'react';\nimport { Formik, Form, Field, ErrorMessage } from 'formik';\nimport { useMutation } from '@apollo/react-hooks';\nimport { LOGIN, USER_FRAGMENT } from './login_query';\nimport { ApolloError } from 'apollo-boost';\n\ntype LoginProps = {\n    loadUser: () => void,\n}\n\nfunction formatError(error: ApolloError): string {\n    const splitMessage = error?.message.split(':');\n    const message =  splitMessage.length > 1 ? splitMessage[1] : splitMessage[0];\n    return message.trim();\n}\n\nfunction Login({loadUser}: LoginProps) {\n    const [ login, { error, client } ] = useMutation(LOGIN, {\n        onError: () => {},\n        onCompleted: (data) => {\n            console.log(data);\n            loadUser();\n            client?.writeFragment({\n                id: data.id,\n                fragment: USER_FRAGMENT,\n                data: data,\n            })\n        }\n    });\n\n    return (\n        <Formik\n            initialValues={{name: '', password: ''}}\n            onSubmit={(values) => login({variables: values})}\n        >\n            <Form>\n                <Field name=\"name\"></Field>\n                <ErrorMessage name=\"name\"></ErrorMessage>\n                <Field type=\"password\" name=\"password\"></Field>\n                <ErrorMessage name=\"password\"></ErrorMessage>\n                <button>Login</button>\n                {error && <span>{formatError(error)}</span>}\n            </Form>\n        </Formik>\n    )\n}\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}