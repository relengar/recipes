{"ast":null,"code":"import _slicedToArray from \"/Users/dude/Documents/stuff/recipes/fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"/Users/dude/Documents/stuff/recipes/fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"/Users/dude/Documents/stuff/recipes/fe/src/components/shoppingList/view_shopping_list/my_ingredients/MyIngredients.tsx\";\nimport React from 'react';\nimport Slider from '@material-ui/core/Slider';\nimport { makeStyles } from '@material-ui/core';\nimport { createStyles } from '@material-ui/styles';\nimport { debounce } from 'lodash';\nimport { useMutation } from '@apollo/react-hooks';\nimport { UPDATE_INGREDIENTS } from './my_ingredients.query';\nconst useStyles = makeStyles(theme => createStyles({\n  root: {\n    width: 200\n  }\n}));\n\nfunction processIngredient(ingredient) {\n  const requiredFields = ['amount', 'original', 'id', 'amountFill', 'unit'];\n  return Object.fromEntries(Object.entries(ingredient).filter(([key]) => requiredFields.some(field => field === key)));\n}\n\nfunction getVariables(amountFill, ingredient, userId, listId) {\n  return {\n    variables: {\n      userId,\n      id: listId,\n      ingredients: [_objectSpread({}, processIngredient(ingredient), {\n        amountFill\n      })]\n    }\n  };\n} // function mapWsUpdates(ingredients: any[], updates: any[]) {\n//     if (!updates?.length) {\n//        return  ingredients;\n//     }\n//     return ingredients.map(ingredient => {\n//         const update = updates.find(({id}) => id === ingredient.id)\n//         return { ...ingredient, ...update } ?? ingredient;\n//     })\n// }\n\n\nfunction MyIngredients({\n  ingredients,\n  listId,\n  userId\n}) {\n  console.table(ingredients);\n  const classes = useStyles();\n\n  const _useMutation = useMutation(UPDATE_INGREDIENTS),\n        _useMutation2 = _slicedToArray(_useMutation, 1),\n        updateIngredients = _useMutation2[0]; // const { data } = useSubscription(INGREDIENTS_SUBSCRIPTION, {\n  //     variables: { userId },\n  // });\n\n\n  const update = debounce(updateIngredients, 300); // ingredients = mapWsUpdates(ingredients, data?.shoppingListIngredients);\n  // const [values, setValues] = React.useState<any[]>(ingredients);\n\n  return React.createElement(\"ul\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64\n    },\n    __self: this\n  }, Array.from(ingredients).map(({\n    id,\n    amount,\n    amountFill,\n    unit,\n    original\n  }, i) => React.createElement(\"li\", {\n    className: \"columns\",\n    key: i + new Date().getTime(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"column\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }, original), React.createElement(\"div\", {\n    className: \"column\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }, React.createElement(Slider, {\n    marks: [{\n      value: 0,\n      label: `0 ${unit}`\n    }, {\n      value: amount,\n      label: `${amount} ${unit}`\n    }] // value={values[i].amountFill}\n    ,\n    valueLabelDisplay: \"auto\",\n    className: classes.root,\n    min: 0,\n    max: amount,\n    defaultValue: amountFill,\n    onChangeCommitted: (e, v) => update(getVariables(v, ingredients[i], userId, listId)),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"column\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, amountFill, \" \", unit))));\n}\n\nexport default MyIngredients;","map":{"version":3,"sources":["/Users/dude/Documents/stuff/recipes/fe/src/components/shoppingList/view_shopping_list/my_ingredients/MyIngredients.tsx"],"names":["React","Slider","makeStyles","createStyles","debounce","useMutation","UPDATE_INGREDIENTS","useStyles","theme","root","width","processIngredient","ingredient","requiredFields","Object","fromEntries","entries","filter","key","some","field","getVariables","amountFill","userId","listId","variables","id","ingredients","MyIngredients","console","table","classes","updateIngredients","update","Array","from","map","amount","unit","original","i","Date","getTime","value","label","e","v"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Slider from '@material-ui/core/Slider';\nimport { makeStyles, Theme } from '@material-ui/core';\nimport { createStyles } from '@material-ui/styles'\nimport { debounce } from 'lodash'\nimport { useMutation, useSubscription } from '@apollo/react-hooks';\nimport { UPDATE_INGREDIENTS, INGREDIENTS_SUBSCRIPTION } from './my_ingredients.query';\n\ninterface MyIngredientsProps {\n    ingredients: any[];\n    listId: string;\n    userId: string;\n}\n\nconst useStyles = makeStyles((theme?: Theme) =>\n  createStyles({\n    root: {\n      width: 200,\n    },\n  }),\n);\n\nfunction processIngredient(ingredient: any) {\n    const requiredFields = ['amount', 'original', 'id', 'amountFill', 'unit'];\n    return Object.fromEntries(\n        Object.entries(ingredient)\n            .filter(([key]) => requiredFields.some(field => field === key))\n    );\n}\n\nfunction getVariables(amountFill: number, ingredient: any, userId: string, listId: string) {\n    return {\n        variables: {\n            userId,\n            id: listId,\n            ingredients: [{...processIngredient(ingredient), amountFill}],\n        }\n    }\n}\n\n// function mapWsUpdates(ingredients: any[], updates: any[]) {\n//     if (!updates?.length) {\n//        return  ingredients;\n//     }\n//     return ingredients.map(ingredient => {\n//         const update = updates.find(({id}) => id === ingredient.id)\n//         return { ...ingredient, ...update } ?? ingredient;\n//     })\n// }\n\nfunction MyIngredients({ ingredients, listId, userId }: MyIngredientsProps) {\n    console.table(ingredients);\n    const classes = useStyles();\n    const [ updateIngredients ] = useMutation(UPDATE_INGREDIENTS);\n    // const { data } = useSubscription(INGREDIENTS_SUBSCRIPTION, {\n    //     variables: { userId },\n    // });\n    const update = debounce(updateIngredients, 300);\n    // ingredients = mapWsUpdates(ingredients, data?.shoppingListIngredients);\n\n    // const [values, setValues] = React.useState<any[]>(ingredients);\n\n    return (\n        <ul>\n            {Array.from(ingredients).map(({ id, amount, amountFill, unit, original}: any, i: number) => (\n                <li className=\"columns\" key={i + new Date().getTime()}>\n                    <div className=\"column\">{original}</div>\n                    <div className=\"column\">\n                        <Slider\n                            marks={[{value: 0, label: `0 ${unit}`}, {value: amount, label: `${amount} ${unit}`}]}\n                            // value={values[i].amountFill}\n                            valueLabelDisplay=\"auto\"\n                            className={classes.root}\n                            min={0}\n                            max={amount}\n                            defaultValue={amountFill}\n                            onChangeCommitted={(e, v) => update(getVariables(v as number, ingredients[i], userId, listId))}\n                        />\n                    </div>\n                    <div className=\"column\">{amountFill} {unit}</div>\n                </li>\n            ))}\n        </ul>\n    );\n}\n\nexport default MyIngredients;"]},"metadata":{},"sourceType":"module"}