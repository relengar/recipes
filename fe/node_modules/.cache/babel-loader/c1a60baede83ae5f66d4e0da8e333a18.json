{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dude/Documents/stuff/recipes/fe/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/dude/Documents/stuff/recipes/fe/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/dude/Documents/stuff/recipes/fe/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{useMutation,useQuery}from'@apollo/react-hooks';import{GET_MY_SHOPPING_LISTS}from'../my_shopping_lists/my-shopping-list.queries';import{CREATE_SHOPPING_LIST}from'./create_shopping_list.query';import{CURRENT_USER}from'../../navbar/authModule/auth_module_query';function processInput(object){return Object.fromEntries(Object.entries(object).filter(function(_ref){var _ref2=_slicedToArray(_ref,1),key=_ref2[0];return key!=='__typename';}));}function CreateShoppingList(_ref3){var _user$currentUser;var recipeId=_ref3.recipeId,recipeTitle=_ref3.recipeTitle,ingredients=_ref3.ingredients,submitted=_ref3.submitted;var _useQuery=useQuery(CURRENT_USER),user=_useQuery.data;var userId=user===null||user===void 0?void 0:(_user$currentUser=user.currentUser)===null||_user$currentUser===void 0?void 0:_user$currentUser.id;var _useMutation=useMutation(CREATE_SHOPPING_LIST,{refetchQueries:[{query:GET_MY_SHOPPING_LISTS,variables:{userId:userId}}]}),_useMutation2=_slicedToArray(_useMutation,1),createList=_useMutation2[0];return React.createElement(React.Fragment,null,userId&&React.createElement(\"button\",{onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return createList({variables:{recipeTitle:recipeTitle,recipeId:parseInt(recipeId,10),ingredients:ingredients.map(processInput),userId:userId}}).then(function(id){return submitted(id);}).catch(function(err){return console.log(err);});case 2:return _context.abrupt(\"return\",_context.sent);case 3:case\"end\":return _context.stop();}}},_callee);})),className:\"button\"},\"Create shopping list\"));}export default CreateShoppingList;","map":{"version":3,"sources":["/Users/dude/Documents/stuff/recipes/fe/src/components/shoppingList/create_shopping_list/CreateShoppingList.tsx"],"names":["React","useMutation","useQuery","GET_MY_SHOPPING_LISTS","CREATE_SHOPPING_LIST","CURRENT_USER","processInput","object","Object","fromEntries","entries","filter","key","CreateShoppingList","recipeId","recipeTitle","ingredients","submitted","user","data","userId","currentUser","id","refetchQueries","query","variables","createList","parseInt","map","then","catch","err","console","log"],"mappings":"wWAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,CAAsBC,QAAtB,KAAsC,qBAAtC,CACA,OAASC,qBAAT,KAAsC,+CAAtC,CACA,OAASC,oBAAT,KAAqC,8BAArC,CACA,OAASC,YAAT,KAA6B,2CAA7B,CAkBA,QAASC,CAAAA,YAAT,CAAyBC,MAAzB,CAAgD,CAC5C,MAAOC,CAAAA,MAAM,CAACC,WAAP,CAAmBD,MAAM,CAACE,OAAP,CAAeH,MAAf,EAAuBI,MAAvB,CAA8B,gDAAEC,GAAF,gBAAWA,CAAAA,GAAG,GAAK,YAAnB,EAA9B,CAAnB,CAAP,CACH,CAED,QAASC,CAAAA,kBAAT,OAAqG,0BAAvEC,CAAAA,QAAuE,OAAvEA,QAAuE,CAA7DC,WAA6D,OAA7DA,WAA6D,CAAhDC,WAAgD,OAAhDA,WAAgD,CAAnCC,SAAmC,OAAnCA,SAAmC,eAC1Ef,QAAQ,CAACG,YAAD,CADkE,CACnFa,IADmF,WACzFC,IADyF,CAEjG,GAAMC,CAAAA,MAAM,CAAGF,IAAH,SAAGA,IAAH,oCAAGA,IAAI,CAAEG,WAAT,4CAAG,kBAAmBC,EAAlC,CAFiG,iBAG1ErB,WAAW,CAACG,oBAAD,CAAuB,CACrDmB,cAAc,CAAE,CAAC,CACbC,KAAK,CAAErB,qBADM,CAEbsB,SAAS,CAAE,CAAEL,MAAM,CAANA,MAAF,CAFE,CAAD,CADqC,CAAvB,CAH+D,8CAGzFM,UAHyF,kBAWjG,MACI,yCAEQN,MAAM,EACN,8BACI,OAAO,sEAAE,yJACQM,CAAAA,UAAU,CAAC,CAACD,SAAS,CAAE,CAAEV,WAAW,CAAXA,WAAF,CAAeD,QAAQ,CAAEa,QAAQ,CAACb,QAAD,CAAW,EAAX,CAAjC,CAAiDE,WAAW,CAAEA,WAAW,CAACY,GAAZ,CAAgBtB,YAAhB,CAA9D,CAA6Fc,MAAM,CAANA,MAA7F,CAAZ,CAAD,CAAV,CACRS,IADQ,CACH,SAACP,EAAD,QAAQL,CAAAA,SAAS,CAACK,EAAD,CAAjB,EADG,EAERQ,KAFQ,CAEF,SAAAC,GAAG,QAAIC,CAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ,CAAJ,EAFD,CADR,6GAAF,EADX,CAMI,SAAS,CAAC,QANd,yBAHR,CADJ,CAiBH,CAED,cAAelB,CAAAA,kBAAf","sourcesContent":["import React from 'react';\nimport { useMutation, useQuery } from '@apollo/react-hooks';\nimport { GET_MY_SHOPPING_LISTS } from '../my_shopping_lists/my-shopping-list.queries';\nimport { CREATE_SHOPPING_LIST } from './create_shopping_list.query';\nimport { CURRENT_USER } from '../../navbar/authModule/auth_module_query';\n\ninterface NewShoppingListProps {\n    recipeId: string;\n    recipeTitle: string;\n    ingredients: ShoppingListIngredient[];\n    submitted: Function;\n}\n\ninterface ShoppingListIngredient {\n    id: number;\n    name: string;\n    original: string;\n    originalName: string;\n    amount: number;\n    unit: string;\n}\n\nfunction processInput<T>(object: T): Partial<T> {\n    return Object.fromEntries(Object.entries(object).filter(([key]) => key !== '__typename'));\n}\n\nfunction CreateShoppingList({ recipeId, recipeTitle, ingredients, submitted }: NewShoppingListProps) {\n    const { data: user } = useQuery(CURRENT_USER);\n    const userId = user?.currentUser?.id\n    const [ createList ] = useMutation(CREATE_SHOPPING_LIST, {\n        refetchQueries: [{\n            query: GET_MY_SHOPPING_LISTS,\n            variables: { userId },\n        }]\n    });\n\n\n    return (\n        <>\n            {\n                userId &&\n                <button\n                    onClick={async() => {\n                        return await createList({variables: { recipeTitle, recipeId: parseInt(recipeId, 10), ingredients: ingredients.map(processInput), userId }})\n                            .then((id) => submitted(id))\n                            .catch(err => console.log(err))\n                    }}\n                    className=\"button\"\n                    >\n                    Create shopping list\n                </button>\n            }\n        </>\n    )\n}\n\nexport default CreateShoppingList"]},"metadata":{},"sourceType":"module"}